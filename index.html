<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <title>
   Markdown Editor with Live Word Count
  </title>
  <style>
   :root {
      --bg: #0b1020;
      --card: #141a2a;
      --text: #e6eafc;
      --muted: #a6b3d8;
      --accent: #4cd1ff;
      --border: #2a3150;
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
      background: radial-gradient(circle at 20% -10%, rgba(76,209,255,0.08), transparent 40%),
                  radial-gradient(circle at 100% 0, rgba(124, 58, 237, 0.08), transparent 40%),
                  var(--bg);
      color: var(--text);
    }

    header {
      position: sticky;
      top: 0;
      z-index: 10;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 14px 20px;
      border-bottom: 1px solid var(--border);
      background: rgba(10, 12, 25, 0.92);
    }

    h1 {
      margin: 0;
      font-size: 1.1rem;
      letter-spacing: .2px;
    }

    /* Live word count badge */
    #markdown-word-count {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      border-radius: 999px;
      background: #1e2a4a;
      color: #fff;
      font-family: ui-monospace, SFMono-Regular, Consolas, "Liberation Mono", monospace;
      font-size: 0.92rem;
      border: 1px solid #2c357a;
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.04);
    }

    main {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
      padding: 16px;
    }

    .panel {
      background: rgba(20,26,42,0.95);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 12px;
      min-height: 60vh;
      box-shadow: 0 6px 20px rgba(0,0,0,0.25);
    }

    label {
      display: block;
      font-size: 0.85rem;
      color: var(--muted);
      margin-bottom: 6px;
    }

    textarea#markdown-input {
      width: 100%;
      height: calc(100% - 28px);
      border: 1px solid #2c315e;
      border-radius: 8px;
      padding: 12px;
      outline: none;
      resize: both;
      background: #0b1020;
      color: #eaf2ff;
      font-family: ui-monospace, SFMono-Regular, Consolas, "Liberation Mono", monospace;
      font-size: 0.95rem;
      line-height: 1.5;
    }

    #markdown-preview {
      width: 100%;
      height: 100%;
      overflow: auto;
      padding: 12px;
      border-radius: 8px;
      border: 1px solid #2c315e;
      background: #0b1020;
    }

    /* Simple markdown styling for preview */
    #markdown-preview h1, #markdown-preview h2, #markdown-preview h3 {
      color: #e6eaff;
    }
    #markdown-preview p { color: #eaf1ff; }
    #markdown-preview code {
      background: rgba(255,255,255,0.08);
      padding: 2px 6px;
      border-radius: 4px;
      border: 1px solid rgba(255,255,255,0.15);
    }
    #markdown-preview pre {
      background: #0a0f1a;
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #2c315e;
      overflow: auto;
    }

    @media (max-width: 900px) {
      main { grid-template-columns: 1fr; }
      textarea#markdown-input { height: 40vh; }
    }
  </style>
  <!-- Marked.js for Markdown rendering -->
  <script crossorigin="anonymous" integrity="sha384-..." src="https://cdn.jsdelivr.net/npm/marked@4.3.0/marked.min.js">
  </script>
 </head>
 <body>
  <header>
   <h1>
    Markdown Editor
   </h1>
   <span aria-live="polite" id="markdown-word-count">
    Words: 0
   </span>
  </header>
  <main>
   <section aria-label="Markdown input" class="panel">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;">
     <label for="markdown-input" style="margin:0;">
      Markdown input
     </label>
     <span style="font-size:0.8rem;color:#a8b3d1;">
      Live word count updates after every render
     </span>
    </div>
    <textarea id="markdown-input" placeholder="Type Markdown here..." spellcheck="false"></textarea>
   </section>
   <section aria-label="Markdown preview" class="panel">
    <div style="margin-bottom:6px;display:flex;justify-content:space-between;align-items:center;">
     <label style="margin:0;">
      Preview (rendered HTML)
     </label>
     <span style="font-size:0.8rem;color:#a8b3d1;">
      Uses marked.js
     </span>
    </div>
    <div id="markdown-preview">
    </div>
   </section>
  </main>
  <script>
   (function() {
      const inputEl = document.getElementById('markdown-input');
      const previewEl = document.getElementById('markdown-preview');
      const badgeEl = document.getElementById('markdown-word-count');
      const wordFormat = new Intl.NumberFormat(undefined, { maximumFractionDigits: 0 });

      // Count words in the Markdown source text
      function countWords(text) {
        if (!text) return 0;
        // Normalize spaces, split by whitespace
        const tokens = text.trim().split(/\s+/);
        let count = 0;
        for (const t of tokens) {
          if (!t) continue;
          // Remove surrounding punctuation to approximate word tokens
          const clean = t.replace(/^[^A-Za-z0-9]+|[^A-Za-z0-9]+$/g, '');
          if (clean.length > 0) count++;
        }
        return count;
      }

      // Render markdown to HTML and update word count
      function renderMarkdown() {
        const md = inputEl.value;
        // Render to the preview area
        previewEl.innerHTML = marked.parse(md, {
          breaks: true,
          smartypants: true
        });
        // Update word count after render
        updateWordCount(md);
      }

      function updateWordCount(mdText) {
        const words = countWords(mdText);
        badgeEl.textContent = 'Words: ' + wordFormat.format(words);
      }

      // Load initial content from input.md if available
      async function loadInitial() {
        try {
          const res = await fetch('input.md');
          if (res.ok) {
            const text = await res.text();
            inputEl.value = text;
          } else {
            console.warn('Could not fetch input.md: status', res.status);
          }
        } catch (e) {
          console.warn('Error fetching input.md', e);
        }
        renderMarkdown();
      }

      // Live updates on input
      inputEl.addEventListener('input', () => {
        renderMarkdown();
      });

      // Initialize
      loadInitial();
    })();
  </script>
 </body>
</html>
